<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>R Basics</title>
    <meta charset="utf-8" />
    <meta name="author" content="Isaac Baumann" />
    <link href="libs/remark-css-0.0.1/default.css" rel="stylesheet" />
    <link href="libs/remark-css-0.0.1/default-fonts.css" rel="stylesheet" />
    <script src="libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
    <script src="libs/jquery-1.12.4/jquery.min.js"></script>
    <link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
    <script src="libs/datatables-binding-0.15/datatables.js"></script>
    <link href="libs/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet" />
    <link href="libs/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet" />
    <script src="libs/dt-core-1.10.20/js/jquery.dataTables.min.js"></script>
    <link href="libs/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet" />
    <script src="libs/crosstalk-1.1.0.1/js/crosstalk.min.js"></script>
  </head>
  <body>
    <textarea id="source">




name: r-basics
class: left, middle, inverse
background-image: url(https://images.unsplash.com/photo-1505413687799-90481dfc0203?ixlib=rb-1.2.1&amp;ixid=eyJhcHBfaWQiOjEyMDd9&amp;auto=format&amp;fit=crop&amp;w=2550&amp;q=80)
background-size: cover

# R Basics

## (for those learning Stata)

.large[Isaac Baumann - 2020-08-06]

---

class: middle, center, inverse

# What is R?

---

class: center, middle

&lt;center&gt;&lt;img src="https://upload.wikimedia.org/wikipedia/commons/thumb/1/1b/R_logo.svg/800px-R_logo.svg.png" height="250" /&gt;&lt;/center&gt;

R is an open-source statistical analysis programming language

--

Lots of tools for many types of statistical analyses

--

Flexible, highly-customizable graphics

--

Become very popular in last ~10 years

---

# Why use R?

Personally, I prefer R but both have pros and cons:

--

&lt;br/&gt;&lt;br/&gt;

.pull-left[
  
  &lt;center&gt;&lt;img src="https://upload.wikimedia.org/wikipedia/commons/thumb/5/5c/Stata_Logo.svg/800px-Stata_Logo.svg.png" height = 100 /&gt;&lt;/center&gt;

  - Ready out-of-the-box
  - Pay-to-play: performance limited by pay tiers
  - Economists, sociologists, some epidemiologists (this is changing)
  - Better table creation functions
  - Stata is much friendlier for econometrics

]

--

.pull-right[
  
  &lt;center&gt;&lt;img src="https://upload.wikimedia.org/wikipedia/commons/thumb/1/1b/R_logo.svg/800px-R_logo.svg.png" height=100 /&gt;&lt;/center&gt;

  - Steeper learning curve, but more customizable
  - Free: performance only limited by your computer
  - Statisticians, data scientists
  - Miles better than Stata for graphs
  - Better tools for data cleaning
  
]

---

# Coding: general comments

--

&lt;p style="color:#FF0000; font-size: 32px"&gt; Learning a programming language is &lt;b&gt;not&lt;/b&gt; like learning a foreign language &lt;/p&gt;

--

I will assume you have &lt;b&gt;no&lt;/b&gt; previous coding experience (if you don't, that's great!)

--

If you do have some previous experience:

--

- Stata is like SAS in some ways

--

- R is more like Python, it also might make sense if you've used SQL

--

Even if you don't like R, try to learn it: R is more like other languages than Stata is

---

# Let's install R!

We'll be downloading two things:

--

.pull-left[

  ## "Base" R
  
  &lt;img src="https://upload.wikimedia.org/wikipedia/commons/thumb/1/1b/R_logo.svg/800px-R_logo.svg.png" height="50" /&gt;
  
  This is the actual "language"
  
  &lt;br/&gt;
  Install R from [the R Project](https://cloud.r-project.org/)
  
]

.pull-right[

  ## RStudio
  
  &lt;img src="https://upload.wikimedia.org/wikipedia/commons/thumb/d/d0/RStudio_logo_flat.svg/1920px-RStudio_logo_flat.svg.png" height="50" /&gt;
  
  We'll use this program to write R scripts
  
  &lt;br/&gt;
  Install from [RStudio](https://rstudio.com/products/rstudio/download/#download)

]

&lt;br/&gt;
&lt;center&gt;&lt;p style="color:#FF0000"&gt;Install base R first, &lt;i&gt;then&lt;/i&gt; RStudio.&lt;/p&gt;&lt;/center&gt;

---

# RStudio

&lt;center&gt;&lt;img src="./images/r-studio.png" width="800" /&gt;&lt;/center&gt;

---

# RStudio

&lt;center&gt;&lt;img src="./images/r-studio1.png" width="800" /&gt;&lt;/center&gt;

&lt;center&gt;&lt;span style="color:#FF0000"&gt;&lt;b&gt;Source window&lt;/b&gt;&lt;/span&gt;: where we'll write R code (scripts)&lt;/center&gt;

---

# RStudio

&lt;center&gt;&lt;img src="./images/r-studio2.png" width="800" /&gt;&lt;/center&gt;

&lt;center&gt;&lt;span style="color:#FF0000"&gt;&lt;b&gt;Console window&lt;/b&gt;&lt;/span&gt;: where R outputs will show when we run code&lt;/center&gt;

---

# RStudio

&lt;center&gt;&lt;img src="./images/r-studio3.png" width="800" /&gt;&lt;/center&gt;

&lt;center&gt;&lt;span style="color:#FF0000"&gt;&lt;b&gt;Environment window&lt;/b&gt;&lt;/span&gt;: lists the datasets we're using&lt;/center&gt;

---

# RStudio

&lt;center&gt;&lt;img src="./images/r-studio4.png" width="800" /&gt;&lt;/center&gt;

&lt;center&gt;&lt;span style="color:#FF0000"&gt;&lt;b&gt;Miscellaneous window&lt;/b&gt;&lt;/span&gt;: shows plots, folders, help pages, etc.&lt;/center&gt;

---

# Hello, world!

Try it out!

In the upper left-hand corner, click the &lt;span style="color:green"&gt;&lt;b&gt;green&lt;/b&gt;&lt;/span&gt; plus icon and pick "R Script"

&lt;center&gt;&lt;img src="./images/r-script.png" width="200" /&gt;&lt;/center&gt;

--

In the new source window, type:


```r
print("Hello world!")
```

--

Then run it! Click to the left of the code (where the number 1 is) and:

- click `Run` on the source window, &lt;i&gt;&lt;b&gt;or&lt;/b&gt;&lt;/i&gt;
- hit `Ctrl+Enter`

---

# Hello, world!

Congrats, you just wrote an R script!

&lt;center&gt;&lt;img src="./images/hello world.png" height="450" /&gt;&lt;/center&gt;

---

# How we use R

--

&lt;center&gt;&lt;img src="https://media1.tenor.com/images/bb9a7f04bd1cced9826bba2a0e45cd35/tenor.gif?itemid=15254720" height="175" /&gt;&lt;/center&gt;

Think of &lt;b&gt;data&lt;/b&gt; like &lt;b&gt;raw construction materials&lt;/b&gt;

--

To build a house, we need &lt;b&gt;tools&lt;/b&gt;: in R&lt;sup&gt;1&lt;/sup&gt;, these are called &lt;b&gt;packages&lt;/b&gt;

--

To store our &lt;b&gt;tools&lt;/b&gt; we need a &lt;b&gt;toolbox&lt;/b&gt;: in R&lt;sup&gt;1&lt;/sup&gt;, this is called the &lt;b&gt;library&lt;/b&gt;

--

To get our &lt;b&gt;tools&lt;/b&gt;, we need to go to &lt;b&gt;Lowe's&lt;/b&gt;: in R, this is called &lt;b&gt;CRAN&lt;/b&gt;&lt;sup&gt;2&lt;/sup&gt;

&lt;/br&gt;
.footnote[

[1] They're called packages and libraries in most languages, really

[2] The &lt;b&gt;C&lt;/b&gt;omprehensive &lt;b&gt;R&lt;/b&gt; &lt;b&gt;A&lt;/b&gt;rchive &lt;b&gt;N&lt;/b&gt;etwork

]

---

# Installing packages

&lt;b&gt;Tidyverse&lt;/b&gt;: the most important package you'll use in R

&lt;center&gt;&lt;img src="https://raw.githubusercontent.com/rstudio/hex-stickers/master/PNG/tidyverse.png" height="150" /&gt;&lt;/center&gt;

--

The Tidyverse is a collection of packages created to help "tidy" up data for clean, efficient data analysis

--

All packages are stored on CRAN, but we can install them directly in R

To install the Tidyverse packages, type:


```r
install.packages("tidyverse")
```

Once it's installed, load the package:


```r
library(tidyverse)
```

---

# Installing packages

There are 16,000+ packages on CRAN: how do you know what they do?

--

All packages are vetted: R is open-source, but it's not Wikipedia

--

Still not sure? Check the help files!


```r
?tidyverse
```

--

Let's try another package:


```r
?print
```

--

But where do you go to look for packages?

--

.pull-left[

&lt;center&gt;&lt;img src="https://upload.wikimedia.org/wikipedia/commons/thumb/2/2f/Google_2015_logo.svg/1920px-Google_2015_logo.svg.png" width="300px" /&gt;&lt;/center&gt;

]

.pull-right[

&lt;center&gt;&lt;img src="https://upload.wikimedia.org/wikipedia/commons/thumb/0/02/Stack_Overflow_logo.svg/1920px-Stack_Overflow_logo.svg.png" width="300px" /&gt;&lt;/center&gt;

]

---

class: center, middle
background-image: url(https://images.unsplash.com/photo-1529322365446-6efd62aed02e?ixlib=rb-1.2.1&amp;ixid=eyJhcHBfaWQiOjEyMDd9&amp;auto=format&amp;fit=crop&amp;w=2551&amp;q=80)
background-size: cover

# Working with data in R

---

# Datasets in R

"Join" in R = "merge" in Stata &lt;i&gt;but&lt;/i&gt; R is way more flexible about merging

--

Let's get some data: **nyflights13** is a package with data for all flights departing NYC in 2013


```r
install.packages("nycflights13")
library(nycflights13)
```

Once it's installed, let's save two datasets from **nycflights13** to our R environment:


```r
a &lt;- flights
b &lt;- airlines
```

---

# Datasets in R


```r
a &lt;- flights
b &lt;- airlines
```

Some notes about what we just did:

--

- `flights` and `airlines` are &lt;b&gt;data frames&lt;/b&gt;
  - Data frames (df) are what R calls datasets
  
--

- `&lt;-` tells R to store something as an &lt;b&gt;object&lt;/b&gt;
  - Objects can be data frames, vectors, lists, matrices, etc.
  
--

- `a` and `b` are what we're telling R to "save" the data as
  - We told R to put `flights` and `airlines` into our current environment and call them `a` and `b`

---

# Datasets in R

You should see `a` and `b` in the environment window. Let's look at them!

--

To view objects in R, just click on them or use `view()`:


```r
view(a)
view(b)
```

Until last year, you couldn't have two datasets open in Stata.

--

&lt;b&gt;ALWAYS&lt;/b&gt; look at your data before joining - there might be problems you wouldn't notice if you just look at variable names and codebooks!

--

There's a `carrier` variable in `a` but it's not the airline's full name: let's use `b` to add the name!

---

# Joining datasets in R

One of the most common things you'll do with data: think about it first!

--

There are many types of joins in R, mostly in the Tidyverse package **dplyr**:

&lt;center&gt;&lt;img src="./images/joins.png", width="400px" /&gt;&lt;/center&gt;

--

If we want to join a few airline names in `b` to many airline codes in `a`, which join should we do?

--

&lt;b&gt;A left join!&lt;/b&gt;

---

# Joining datasets in R

To join two datasets, we need to tell R what we want to join and how we want to join it:


```r
left_join(a, b, by = "carrier")
```

--

This tells R to:

--

- Join `b` to `a`

--

- Join them by the common variable "carrier" (the two-letter airline codes)
  - The join-by variables in each df need to have the same name

--

ðŸŽ‰ &lt;span style="color:green"&gt;&lt;b&gt;This does not change the original data!&lt;/b&gt;&lt;/span&gt; ðŸŽ‰

--

If we had done this in Stata, it would have changed `a`, the dataset we're joining `b` to. &lt;span style="color:red"&gt;&lt;b&gt;This sucks if the join doesn't work like you thought it would!&lt;/b&gt;&lt;/span&gt;

--

R is forgiving: if the join doesn't work, you can just fix it and try again!

---

# Joining datasets in R

Run the code: a preview prints to the console but `a` and `b` are unchanged.

--

Instead of permanently changing `a`, let's create a new object with the finished join called `c`:


```r
c &lt;- left_join(a, b, by = "carrier")
```

If the join works correctly, `c` should look just like `a` but with one more variable that has airline names

--

Go look at `c`: it should have an airline name variable now!

--

&lt;center&gt;&lt;img src="./images/airline join.png" width="500px" /&gt;&lt;/center&gt;

---

# Cleaning up

How do we remove things from R? Use `rm()`

--

You can remove multiple items from RStudio using `rm()`:


```r
rm(a, b, c)
```

--

Or use the &amp;#129529; icon to clean out everything

&lt;center&gt;&lt;img src="./images/broom.png" width="450px" /&gt;&lt;/center&gt;

---

class: center, inverse
background-image: url("https://media.giphy.com/media/l1uguGf2RVIsTXNDO/giphy.gif")
background-size: cover

---

class: inverse

# Star Wars

&lt;center&gt;&lt;img src="https://i.pinimg.com/originals/09/18/ed/0918eda1f57759878bb0a1391bc0ec74.gif" width="4000px" /&gt;&lt;/center&gt;

Let's learn some more stuff with Star Wars

Download `starwars.csv` from my [Github page](https://raw.githubusercontent.com/i-baumann/R-Basics/master/starwars.csv?raw=true)

--

Open a new R script in RStudio

---

class: inverse

# Star Wars

## Scripting

Scripting is all about reproducibility

--

A .do file in Stata is a sequence of functions:
--
 so is a .R file in R!
 
--

Use the source window for scripting: avoid coding in the console
 
--

First, load packages:


```r
library(tidyverse)
```

--

Even if it's loaded in R now it might not be the next time!

---

class: inverse

# Star Wars

## Working directories

So far we've done everything inside the RStudio environment

--

As with most languages, including Stata, you'll be working out of a **working directory**: just a folder where things for a project live

--

Setting your wd in RStudio is easy:

--

In the miscellaneous window, click the `files` tab, then `...` in the top right corner, and navigate to where you saved `starwars.csv`

--

The folder will open in the window, then the &amp;#9881; icon, and `set as working directory`

--

If you're comfortable with file pathing, you can also use `setwd()`:


```r
setwd("./Isaac/Example Star Wars Folder/")
```

---

class: inverse

# Star Wars

Like Stata, R can work with many types of data files (even Stata files!)

CSVs are common: base R can read them in but the Tidyverse's **readr** package is nice

--

`File -&gt; Import Dataset -&gt; From Text (readr)`

--

Use `browse` to find `starwars.csv` (**readr** will open in the wd you set)

--

&lt;center&gt;&lt;img src="./images/readr.png" width="500px" /&gt;&lt;/center&gt;

---

class: inverse

# Star Wars

&lt;center&gt;&lt;img src="./images/readr.png" width="600px" /&gt;&lt;/center&gt;

--

**readr** previews the data

--

The code box in the right bottom corner: you can copy or edit if you need to!

--

It will load **readr**, even if you don't have the Tidyverse loaded

--

Click `import`!

---

class: inverse

# Star Wars

**readr** will automatically put the df in `view` for you

--

Go ahead and look at the data

--

<div id="htmlwidget-2e444ba054560ff5acf4" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-2e444ba054560ff5acf4">{"x":{"filter":"none","data":[["1","2","3","4","5","6"],["Luke Skywalker","C-3PO","R2-D2","Darth Vader","Leia Organa","Owen Lars"],[172,167,96,202,150,178],[77,75,32,136,49,120],["blond",null,null,"none","brown","brown, grey"],["fair","gold","white, blue","white","light","light"],["blue","yellow","red","yellow","brown","blue"],[19,112,33,41.9,19,52],["male","none","none","male","female","male"],["masculine","masculine","masculine","masculine","feminine","masculine"],["Tatooine","Tatooine","Naboo","Tatooine","Alderaan","Tatooine"],["Human","Droid","Droid","Human","Human","Human"],[["The Empire Strikes Back","Revenge of the Sith","Return of the Jedi","A New Hope","The Force Awakens"],["The Empire Strikes Back","Attack of the Clones","The Phantom Menace","Revenge of the Sith","Return of the Jedi","A New Hope"],["The Empire Strikes Back","Attack of the Clones","The Phantom Menace","Revenge of the Sith","Return of the Jedi","A New Hope","The Force Awakens"],["The Empire Strikes Back","Revenge of the Sith","Return of the Jedi","A New Hope"],["The Empire Strikes Back","Revenge of the Sith","Return of the Jedi","A New Hope","The Force Awakens"],["Attack of the Clones","Revenge of the Sith","A New Hope"]],[["Snowspeeder","Imperial Speeder Bike"],[],[],[],"Imperial Speeder Bike",[]],[["X-wing","Imperial shuttle"],[],[],"TIE Advanced x1",[],[]]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>name<\/th>\n      <th>height<\/th>\n      <th>mass<\/th>\n      <th>hair_color<\/th>\n      <th>skin_color<\/th>\n      <th>eye_color<\/th>\n      <th>birth_year<\/th>\n      <th>sex<\/th>\n      <th>gender<\/th>\n      <th>homeworld<\/th>\n      <th>species<\/th>\n      <th>films<\/th>\n      <th>vehicles<\/th>\n      <th>starships<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"searching":false,"pageLength":1,"scrollX":true,"columnDefs":[{"className":"dt-right","targets":[2,3,7]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[1,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>

---

class: inverse

# Star Wars

Let's find out how many planets are in `starwars`

--

In R, you select a column by name with a `$` or `["column name"]` after the df name:


```r
dataframe$column_name
dataframe["column_name"]
```

--

In `starwars` the planet variable/column is `homeworld`, so:


```r
starwars$homeworld
```

---

class: inverse

# Star Wars


```r
starwars$homeworld
```

--


```
##  [1] "Tatooine"       "Tatooine"       "Naboo"          "Tatooine"      
##  [5] "Alderaan"       "Tatooine"       "Tatooine"       "Tatooine"      
##  [9] "Tatooine"       "Stewjon"        "Tatooine"       "Eriadu"        
## [13] "Kashyyyk"       "Corellia"       "Rodia"          "Nal Hutta"     
## [17] "Corellia"       "Bestine IV"     NA               "Naboo"         
## [21] "Kamino"         NA               "Trandosha"      "Socorro"       
## [25] "Bespin"         "Mon Cala"       "Chandrila"      NA              
## [29] "Endor"          "Sullust"        NA               "Cato Neimoidia"
## [33] "Coruscant"      "Naboo"          "Naboo"          "Naboo"         
## [37] "Naboo"          "Toydaria"       "Malastare"      "Naboo"         
...
```

--

Not very helpful! R gives us the whole column, duplicates and all!

---

class: inverse

# Star Wars

`unique()` to the rescue!

--


```r
unique(starwars$homeworld)
```

--


```
##  [1] "Tatooine"       "Naboo"          "Alderaan"       "Stewjon"       
##  [5] "Eriadu"         "Kashyyyk"       "Corellia"       "Rodia"         
##  [9] "Nal Hutta"      "Bestine IV"     NA               "Kamino"        
## [13] "Trandosha"      "Socorro"        "Bespin"         "Mon Cala"      
## [17] "Chandrila"      "Endor"          "Sullust"        "Cato Neimoidia"
## [21] "Coruscant"      "Toydaria"       "Malastare"      "Dathomir"      
## [25] "Ryloth"         "Vulpter"        "Troiken"        "Tund"          
## [29] "Haruun Kal"     "Cerea"          "Glee Anselm"    "Iridonia"      
## [33] "Iktotch"        "Quermia"        "Dorin"          "Champala"      
## [37] "Geonosis"       "Mirial"         "Serenno"        "Concord Dawn"  
...
```

---

class: inverse

# Star Wars

We can even alphabetize the vector using `sort()`:


```r
sort(unique(starwars$homeworld))
```

--


```
##  [1] "Alderaan"       "Aleen Minor"    "Bespin"         "Bestine IV"    
##  [5] "Cato Neimoidia" "Cerea"          "Champala"       "Chandrila"     
##  [9] "Concord Dawn"   "Corellia"       "Coruscant"      "Dathomir"      
## [13] "Dorin"          "Endor"          "Eriadu"         "Geonosis"      
## [17] "Glee Anselm"    "Haruun Kal"     "Iktotch"        "Iridonia"      
## [21] "Kalee"          "Kamino"         "Kashyyyk"       "Malastare"     
## [25] "Mirial"         "Mon Cala"       "Muunilinst"     "Naboo"         
## [29] "Nal Hutta"      "Ojom"           "Quermia"        "Rodia"         
## [33] "Ryloth"         "Serenno"        "Shili"          "Skako"         
## [37] "Socorro"        "Stewjon"        "Sullust"        "Tatooine"      
...
```

---

class: inverse

# Star Wars

Say we're only interested in Tatooine: use **dplyr**'s `filter()` function to get only the Star Wars people from Tatooine:


```r
filter(starwars, homeworld == "Tatooine")
```

--


```
## # A tibble: 10 x 14
##    name  height  mass hair_color skin_color eye_color birth_year sex   gender
##    &lt;chr&gt;  &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; 
##  1 Lukeâ€¦    172    77 blond      fair       blue            19   male  mascuâ€¦
##  2 C-3PO    167    75 &lt;NA&gt;       gold       yellow         112   none  mascuâ€¦
##  3 Dartâ€¦    202   136 none       white      yellow          41.9 male  mascuâ€¦
##  4 Owenâ€¦    178   120 brown, grâ€¦ light      blue            52   male  mascuâ€¦
##  5 Beruâ€¦    165    75 brown      light      blue            47   femaâ€¦ feminâ€¦
##  6 R5-D4     97    32 &lt;NA&gt;       white, red red             NA   none  mascuâ€¦
##  7 Biggâ€¦    183    84 black      light      brown           24   male  mascuâ€¦
...
```

--

Like before, this doesn't change `starwars`!

We can overwrite `starwars` if we want to using `&lt;-` or make our Tatooine filter into a new dataset.

---

class: inverse

# Star Wars

Can we explain differences in Star Wars characters' weights?

--

What might be some variables that affect weight?

--

Use `colnames()` or `ls()` to look at column/variable names in console:


```r
colnames(starwars)
ls(starwars)
```

--


```
##  [1] "birth_year" "eye_color"  "films"      "gender"     "hair_color"
##  [6] "height"     "homeworld"  "mass"       "name"       "sex"       
## [11] "skin_color" "species"    "starships"  "vehicles"
```

--

Let's look at:

--

- `height`

--

- `homeworld`

--

- `species`

--

Let's use &lt;i&gt;regression&lt;/i&gt; to check this out

---

class: inverse

# Star Wars

Use `lm()` (linear model) to do a linear regression in R

--


```r
lm(y ~ x, data = df_name)
```

--

- `y` is the response or dependent variable

--

- `x` is a regressor or independent variable

--

- `~` is like `=` (but only in `lm()`)

--

- `df_name` is the name of the data we're telling `lm()` to use

--

What's our `y`? What's our `x`(s)? What's our `df_name`?

--

In R it's usually a good idea to store regression results as objects so you don't have to re-run:


```r
model &lt;- lm(mass ~ height + homeworld + species, data = starwars)
```

---

class: inverse

# Star Wars

Let's view the results!

--


```r
model
```

```
## 
## Call:
## lm(formula = mass ~ height + homeworld + species, data = starwars)
## 
## Coefficients:
##             (Intercept)                   height     homeworldAleen Minor  
##                -88.7064                   0.7558                  43.9948  
##         homeworldBespin      homeworldBestine IV  homeworldCato Neimoidia  
##                 10.4649                  37.6857                  34.3403  
##          homeworldCerea    homeworldConcord Dawn        homeworldCorellia  
##                 21.0493                   4.4182                   9.9649  
##      homeworldCoruscant        homeworldDathomir           homeworldDorin  
##                 -0.3688                  36.4338                  26.6078  
##          homeworldEndor        homeworldGeonosis     homeworldGlee Anselm  
##                 42.1922                  30.3870                  27.5610  
...
```

---

class: inverse

# Star Wars

Not very useful...
--
 let's use `summary()`
  

```r
summary(model)
```

--


```
## 
## Call:
## lm(formula = mass ~ height + homeworld + species, data = starwars)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -21.59   0.00   0.00   0.00  28.80 
## 
## Coefficients: (26 not defined because of singularities)
##                          Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)              -88.7064    52.2128  -1.699  0.11312    
## height                     0.7558     0.2151   3.515  0.00381 ** 
## homeworldAleen Minor      43.9948    40.9761   1.074  0.30250    
## homeworldBespin           10.4649    18.8319   0.556  0.58785    
## homeworldBestine IV       37.6857    18.9360   1.990  0.06803 .  
...
```

---

class: inverse

# Star Wars

Questions:

- What's significant?

--

- Why is only one planet very significant?

--

- Why are most of the species coefficients `NA`?

---

class: inverse

# Star Wars

## Data visualization

--

Base R has some _basic_ graphic tools

--

Mostly good for quick and dirty data visualization

--

`plot` and `hist` are good for basic scatterplots and histograms

--

### Scatterplots in base R


```r
plot("first variable","second variable")
```

--

Let's look at `mass` and `height` in a scatterplot:


```r
plot(starwars$mass,starwars$height)
```

---

class: inverse

# Star Wars

## Data visualization

.pull-left[

```r
plot(starwars$mass,starwars$height)
```
]

.pull-right[

&lt;img src="r_basics_files/figure-html/unnamed-chunk-36-1.png" width="504" /&gt;

]

---

class: inverse

# Star Wars

## Data visualization

Histograms are frequency plots: they tell us how many times a value appears

--


```r
hist("variable",breaks = "how many bars we want")
```

--

Let's make a histogram of Star Wars characters' weights:


```r
hist(starwars$mass)
```

---

class: inverse

# Star Wars

## Data visualization

.pull-left[

```r
hist(starwars$mass)
```
]

.pull-right[
&lt;img src="r_basics_files/figure-html/unnamed-chunk-40-1.png" width="504" /&gt;
]

---

class: inverse

# Star Wars

## Data visualization

.pull-left[

```r
hist(starwars$mass, `breaks = 100`)
```
]

.pull-right[
&lt;img src="r_basics_files/figure-html/unnamed-chunk-42-1.png" width="504" /&gt;
]

---

class: inverse

# Star Wars

## Data visualization

&lt;br/&gt;
&lt;center&gt;&lt;img src="https://thumbs.gfycat.com/KaleidoscopicSecondaryGazelle-small.gif", width = 700 /&gt;&lt;/center&gt;

---

class: inverse

# Star Wars

## Data visualization

.pull-left[

Base R plots:

&lt;img src="./images/yoad.png", height = 300 /&gt;

]

--

.pull-right[

ggplot2 plots:

&lt;img src="https://vignette.wikia.nocookie.net/starwars/images/9/98/Yoda1280.jpg/revision/latest?cb=20070224213010", height=300 /&gt;

]

---

class: inverse

# Star Wars

## Data visualization: ggplot2

&lt;center&gt;&lt;img src="https://raw.githubusercontent.com/rstudio/hex-stickers/master/PNG/ggplot2.png", height=200 /&gt;&lt;/center&gt;

ggplot2 is _another_ Tidyverse package

--

Highly customizable, but tough to get used to

--

Can take a lot of coding: many, many functions for adding layers, editing labels, etc.

--

Easily pass data to ggplot2 functions

---

class: inverse

# Star Wars

## Data visualization: ggplot2

The idea behind ggplot2 is you build graphics by:

--

- Passing data to ggplot

--

- Adding "aesthetic" commands: tell ggplot what to do with the data

--

- Adding other ggplot functions to customize

--

We could spend a whole presentation just on ggplot: let's do some simple plots

---

class: inverse

# Star Wars

## Data visualization: ggplot2

Let's recreate our scatterplot in ggplot2:

--


```r
ggplot(data = starwars, aes(x = mass, y = height)) + geom_point()
```

--

`ggplot` preps the data - we're telling ggplot:

--

- Use `starwars` as our dataset

- `mass` is the x axis variable

- `height` is the y axis variable

--

geom functions tell ggplot what kind of graph we want

--

- `geom_point` tells ggplot we want a scatterplot

---

class: inverse

# Star Wars

## Data visualization: ggplot2

.pull-left[

```r
ggplot(data = starwars, aes(x = mass, 
                            y = height)) + 
  geom_point()
```
]

.pull-right[
&lt;img src="r_basics_files/figure-html/unnamed-chunk-45-1.png" width="504" /&gt;
]

--

Not very different - let's get fancy

---

class: inverse

# Star Wars

## Data visualization: ggplot2

How about adding a title?

.pull-left[

```r
ggplot(data = starwars, aes(x = mass, 
                            y = height)) + 
  geom_point() +
  `labs(title = "Star Wars Weight &amp; Height")`
```
]

.pull-right[
&lt;img src="r_basics_files/figure-html/unnamed-chunk-47-1.png" width="504" /&gt;
]

---

class: inverse

# Star Wars

## Data visualization: ggplot2

Let's change the dots to stars:

.pull-left[

```r
ggplot(data = starwars, aes(x = mass, 
                            y = height)) + 
  geom_point(`shape = 8`) +
  labs(title = "Star Wars Weight &amp; Height")
```
]

.pull-right[
&lt;img src="r_basics_files/figure-html/unnamed-chunk-49-1.png" width="504" /&gt;
]

---

class: inverse

# Star Wars

## Data visualization: ggplot2

Make them smaller and change the color:

.pull-left[

```r
ggplot(data = starwars, aes(x = mass, 
                            y = height)) + 
  geom_point(shape = 8, 
             `size = .75, color = "red"`) +
  labs(title = "Star Wars Weight &amp; Height")
```
]

.pull-right[
&lt;img src="r_basics_files/figure-html/unnamed-chunk-51-1.png" width="504" /&gt;
]

---

class: inverse

# Star Wars

## Data visualization: ggplot2

Get rid of Jabba the Hutt and plot a line of best fit:

.pull-left[

```r
ggplot(data = `filter(starwars, mass &lt; 500)`, 
       aes(x = mass, y = height)) + 
  geom_point(shape = 8, 
             size = .75, color = "red") +
  labs(title = "Star Wars Weight &amp; Height") +
  `geom_smooth(method = "lm")`
```
]

.pull-right[
&lt;img src="r_basics_files/figure-html/unnamed-chunk-53-1.png" width="504" /&gt;
]

---

class: inverse

# Star Wars

## Data visualization: ggplot2

Go the the Dark Side!

.pull-left[

```r
ggplot(data = filter(starwars, mass &lt; 500), 
       aes(x = mass, y = height)) + 
  geom_point(shape = 8, 
             size = .75, color = "red") +
  labs(title = "Star Wars Weight &amp; Height") +
  geom_smooth(method = "lm") +
  `theme_dark()`
```
]

.pull-right[
&lt;img src="r_basics_files/figure-html/unnamed-chunk-55-1.png" width="504" /&gt;
]

---

class: inverse

# Star Wars

## Data visualization: ggplot2

Histograms are also easy: just change the geom!

--

Histograms are a frequency of one variable: let's do mass (height won't be the y axis)


```r
ggplot(data = starwars, aes(x = mass)) + 
  geom_histogram()
```

---

class: inverse

# Star Wars

## Data visualization: ggplot2

.pull-left[

```r
ggplot(data = starwars, aes(x = mass)) + 
  geom_histogram()
```
]

.pull-right[
&lt;img src="r_basics_files/figure-html/unnamed-chunk-58-1.png" width="504" /&gt;
]

---

class: inverse

# Star Wars

## Data visualization: ggplot2

Increase the number of bins:

.pull-left[

```r
ggplot(data = starwars, aes(x = mass)) + 
  geom_histogram(`bins = 100`)
```
]

.pull-right[
&lt;img src="r_basics_files/figure-html/unnamed-chunk-60-1.png" width="504" /&gt;
]

---

class: inverse

# Star Wars

## Data visualization: ggplot2

Can we group the data?
--
 *Absolutely!*
--
 Let's look at mass by gender:
 
--

.pull-left[

```r
ggplot(data = starwars, 
       aes(x = mass, `color = gender`)) + 
  geom_histogram(bins = 100)
```
]

.pull-right[
&lt;img src="r_basics_files/figure-html/unnamed-chunk-62-1.png" width="504" /&gt;
]

---

class: inverse

# Star Wars

## Data visualization: ggplot2

Fill in the bars and "dodge" them:

.pull-left[

```r
ggplot(data = starwars, 
       aes(x = mass, color = gender, 
           `fill = gender`)) + 
  geom_histogram(bins = 100, 
           `position = "dodge2"`)
```
]

.pull-right[
&lt;img src="r_basics_files/figure-html/unnamed-chunk-64-1.png" width="504" /&gt;
]

---

class: inverse

# Star Wars

## Data visualization: ggplot2

ggplot is almost _infinitely_ customizable

--

You can make [maps](https://ggplot2.tidyverse.org/reference/map_data.html)

--

You can even [draw BB-8](https://gist.github.com/pvictor/2f1b498b90fab5427b1b0103d51e509a)!

&lt;center&gt;&lt;img src = "https://cloud.githubusercontent.com/assets/4415580/14786276/7367d6e4-0afe-11e6-998d-8956dc034916.png", height = 250 /&gt;&lt;/center&gt;

---

class: inverse

# Star Wars

## Finishing up: saving data

We're done with our Star Wars project: what now?

--

R's data files have an `.rda` extension.
--
 .rda files:

--

- are for R what .dta files are for Stata

--

- auto-load into R (no need for `readr` or other packages)

--

- are automatically compressed, saving space

--

Let's save `starwars`!

--


```r
save(starwars, file = "starwars.rda")
```

--

Automatically saves to wd: if you want it elsewhere, give a new file path:


```r
save(starwars, file = "~/Desktop/starwars.rda")
```

---

class: inverse

# Star Wars

## Finishing up: saving code

We saved our data: now let's save our R script

--

R scripts save as `.R` files

--

Like Stata's .do files

--

Save your script: `File -&gt; Save As`

--

Or click the &amp;#128190; icon at the top of the source window

--

_If you code carefully_, your script will run all the way through on one click with no errors

--

_Think ahead while scripting_: don't take shortcuts, take the time to do it right

---

# R-esources

--

## R basics

- [R Bloggers](https://www.r-bloggers.com/): tutorials and subject-specific help

- [STHDA](http://www.sthda.com/english/): more tutorials and help pages

- [One R Tip a Day](https://twitter.com/RLangTip?ref_src=twsrc%5Egoogle%7Ctwcamp%5Eserp%7Ctwgr%5Eauthor): Twitter account with daily R tips

- Lots more: R has a large, very helpful online community
--
 (Stata's community is smaller and kinda cranky)

--

## Tidyverse

- [Tidyverse package sites](https://www.tidyverse.org/packages/): info about Tidyverse packages and functions

- [R for Data Science](https://r4ds.had.co.nz/) by Hadley Wickham: great (free!) beginner book on R, doing statistics in R, and tidy data

---

# R-esources

## RStudio

- [RStudio Community](https://community.rstudio.com/): RStudio's official community page (forums, questions, etc.)

- [RStudio Blog](https://blog.rstudio.com/): RStudio's official blog

- [RStudio cheatsheets](https://rstudio.com/resources/cheatsheets/): quick guides to using RStudio and many Tidyverse packages

--

## Using R for econometrics

- [Econometrics with R](https://www.econometrics-with-r.org/): (free!) textbook for metrics in R

- [Wooldridge package](https://cran.r-project.org/web/packages/wooldridge/index.html): datasets from Wooldridge's famous metrics book (useful for 640 and 641 homework)

---

# Cool stuff

- Creating a [map of Middle Earth](https://twitter.com/andrewheiss/status/1291380121069330432) in ggplot2

- [Tidy Tuesday](https://www.tidytuesday.com/): small weekly R projects (and a podcast!)

- Make [slide decks](https://bookdown.org/yihui/rmarkdown/xaringan.html) in RStudio (like this one!)

- Build web apps in R with [Shiny](https://shiny.rstudio.com/gallery/)

- UC Irvine's [machine learning datasets](http://archive.ics.uci.edu/ml/datasets.php)

- Use the [tidycensus package](https://cran.r-project.org/web/packages/tidycensus/tidycensus.pdf) to download tidy Census data from the Census API

- [R Graph gallery](https://www.r-graph-gallery.com/): cool graphs people have made with ggplot

- Output R regression results tables to [LaTeX](https://cran.r-project.org/web/packages/stargazer/vignettes/stargazer.pdf) and [Word](https://sejdemyr.github.io/r-tutorials/basics/tables-in-r/)

---

class: center, middle

&lt;img class="circle" src="https://github.com/i-baumann.png" width=150 /&gt;

[&lt;svg style="height:0.8em;top:.04em;position:relative;" viewBox="0 0 496 512"&gt;&lt;path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/&gt;&lt;/svg&gt; @i-baumann](http://github.com/i-baumann)  
[&lt;svg style="height:0.8em;top:.04em;position:relative;" viewBox="0 0 512 512"&gt;&lt;path d="M476 3.2L12.5 270.6c-18.1 10.4-15.8 35.6 2.2 43.2L121 358.4l287.3-253.2c5.5-4.9 13.3 2.6 8.6 8.3L176 407v80.5c0 23.6 28.5 32.9 42.5 15.8L282 426l124.6 52.2c14.2 6 30.4-2.9 33-18.2l72-432C515 7.8 493.3-6.8 476 3.2z"/&gt;&lt;/svg&gt; dbaumann@sdsu.edu](mailto:dbaumann@sdsu.edu)
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false,
"highlightSpans": true,
"ratio": "16:9"
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
